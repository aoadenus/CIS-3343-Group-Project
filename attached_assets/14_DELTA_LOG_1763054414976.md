# Emily Bakes Cakes: Delta Log - Changes from Original Scope

**Version:** 1.0  
**Last Updated:** November 5, 2025  
**Purpose:** Track all scope changes with rationale and impact

---

## Executive Summary

The original project scope was significantly misaligned with professor requirements. The team designed an e-commerce platform for customers with online ordering, chatbots, and AI features. The professor's clarification shifted the focus to an internal staff-only order management system. This document catalogs all changes made to align with requirements.

---

## Scope Removals (Features Deleted)

| Feature | Original Purpose | Reason Removed | Impact |
|---------|-----------------|-----------------|--------|
| **Customer Portal** | Users login to place orders | Customers don't place orders online | Removed: 15+ pages, login system, customer dashboard |
| **Online Checkout** | Payment for custom orders | Staff enter orders, customers pay in-person | Removed: Stripe integration, shopping cart, payment form |
| **Chatbot** | AI support for customers | Out of scope per professor | Removed: ChatGPT API, conversation flow |
| **3D Cake Builder** | Visual customization tool | Complex, not needed for staff workflow | Removed: Three.js library, WebGL rendering |
| **Occasion Field** | Cake purpose selection | Explicitly removed by professor | Removed: 1 form field, filtering logic |
| **Servings Calculation** | Auto-size suggestion | Replaced with firm cake sizes | Removed: Algorithm, lookup table |
| **Price Ranges** | "$71+ per tier" pricing | Must use firm prices only | Removed: Dynamic pricing logic, tier system |
| **Recommendation Engine** | ML-based suggestions | Out of scope for staff app | Removed: ML model training, preference tracking |
| **Subscription Service** | Monthly cake box | Out of scope | Removed: Recurring billing, tier management |
| **Inventory Management** | Track ingredients | Out of scope | Removed: Inventory table, reorder alerts |
| **SMS Notifications** | Text message updates | Out of scope | Removed: Twilio integration |
| **Video Consultations** | Virtual design meetings | Out of scope | Removed: Video conferencing, calendar integration |

---

## Scope Additions (New Features Required)

| Feature | Reason Added | Implementation | Impact |
|---------|-------------|-----------------|--------|
| **Staff-Only App** | Core requirement from professor | Authentication, role-based access | Changed entire architecture from public to private |
| **Per-Layer Customization** | Support 7-layer custom cakes | ORDER_LAYER table with per-layer options | Added complexity to order form (critical feature) |
| **Design Image Upload** | Show cake designs to staff | FILE_UPLOAD component, S3 storage | Added 50+ KB per upload |
| **Manager Reports** | Track revenue by date range | Dashboard with KPI cards, date filtering | Added 10+ database queries |
| **Order Status Workflow** | Track cake production | Status table, workflow logic | Added state machine validation |
| **Firm Price Enforcement** | Business requirement | Database constraint, form validation | Simplified pricing but requires business logic |
| **Deposit Validation** | 50% minimum requirement | Form validation, database constraint | Critical business rule |
| **Employee Management** | Assign orders to staff | EMPLOYEE table, role-based access | Added auth complexity |
| **Dynamic Dropdowns** | No hardcoded values | Database-driven PRODUCT_OPTION | Requires migration from static data |
| **Production Sheet Printing** | Help bakery staff | Print-friendly component, PDF export | Added reporting feature |

---

## Major Architectural Changes

### Change 1: User Type

**Before:**
\`\`\`
Public Users (Customers)
├─ Browse cakes
├─ Customize online
├─ Place orders
├─ Pay online
└─ Track status
\`\`\`

**After:**
\`\`\`
Internal Users (Staff Only)
├─ Login with credentials
├─ Enter orders on behalf of customers
├─ Manage order workflow
├─ Access reports
└─ No customer access
\`\`\`

**Rationale:** Customers call/email/visit, staff use app internally

**Database Impact:**
- Removed: CUSTOMER_LOGIN, SHOPPING_CART, PAYMENT_INFO tables
- Added: EMPLOYEE, EMPLOYEE_ROLE, AUTH_TOKEN tables

---

### Change 2: Pricing Model

**Before:**
\`\`\`
Dynamic Pricing Tiers:
- Small cake: $45-$55
- Medium cake: $65-$75  
- Large cake: "$71+"
- Custom multipliers based on options
\`\`\`

**After:**
\`\`\`
Firm Pricing:
- Small: $40.00 (fixed)
- Medium: $55.00 (fixed)
- Large: $75.00 (fixed)
- Layer adjustments: per PRODUCT_OPTION
- Total: Calculated, no ranges
\`\`\`

**Rationale:** Professor: "Choose a firm price not 71 plus"

**Code Changes:**
- Removed: Price calculator with ranges
- Added: Decimal(10,2) firm_price field, validation
- Changed: order.total_price → order.firm_price (semantically different)

---

### Change 3: Customization Structure

**Before:**
\`\`\`
Order
└─ Single Cake
   └─ Occasion (e.g., Birthday)
   └─ Servings (auto-selected size)
   └─ Options (limited set)
\`\`\`

**After:**
\`\`\`
Order
└─ Single Cake (from PRODUCT)
   └─ Cake Size (from CAKE_SIZE table)
      └─ Layer 1
         ├─ Flavor (from PRODUCT_OPTION)
         ├─ Filling (from PRODUCT_OPTION)
         ├─ Icing (from PRODUCT_OPTION)
         ├─ Writing Color (from PRODUCT_OPTION)
         ├─ Notes
         └─ Images
      └─ Layer 2-7 (same structure)
\`\`\`

**Rationale:** Professor: "Many options for cake later, icing flavor, writing color, answered per layer"

**Database Changes:**
- Added: ORDER_LAYER, ORDER_LAYER_OPTION, ORDER_ATTACHMENT tables
- Removed: OCCASION field
- Modified: PRODUCT_OPTION now supports multiple per layer

---

### Change 4: Frontend Architecture

**Before:**
\`\`\`
Public Website (Customer-facing)
├─ Product Gallery
├─ Cake Customizer
├─ Shopping Cart
├─ Checkout
├─ Order Tracking
└─ Account Portal

Admin Dashboard (for Emily/James only)
\`\`\`

**After:**
\`\`\`
Internal Application (Staff only)
├─ Dashboard (orders, stats)
├─ Order List (search, filter)
├─ New Order Wizard (multi-step)
├─ Customer Management
├─ Reports & Analytics
└─ Admin Config

Public Website (Marketing only, separate)
├─ Gallery
├─ About
├─ Contact (email inquiry form)
└─ Staff Login Link
\`\`\`

**Code Impact:**
- Removed: ~20 customer-facing pages
- Added: 10+ staff-focused pages
- Changed: All components require authentication

---

### Change 5: Workflow

**Before:**
\`\`\`
Customer → Browse → Customize → Add to Cart → 
Checkout → Pay → Order Placed → Wait for Email
\`\`\`

**After:**
\`\`\`
Customer → Call/Email/Visit
Staff → Login → Create Order → Add Customer → 
Select Cake → Customize Layers → Set Pickup → 
Set Price/Deposit → Confirm → Order Saved

Staff → Status Updates → In Baking → Decorating → 
Ready for Pickup

Customer → Notified by Staff (phone call, not email)
\`\`\`

**Rationale:** "Customers will call, email, or visit the bakery"

---

## Form Changes

### Order Entry Form

**Before:**
\`\`\`
- Product selection
- Occasion dropdown ❌ REMOVED
- Serving size calculator ❌ REMOVED
- Price range selector ❌ REMOVED
- Simple customization (fixed options)
- Design preview in 3D ❌ REMOVED
- Online payment ❌ REMOVED
\`\`\`

**After:**
\`\`\`
✅ Customer selection (new - required first)
✅ Product selection
✅ Cake size selection (firm options only)
✅ Layer repeater (up to 7 layers)
  - Flavor dropdown (dynamic from DB)
  - Filling dropdown (dynamic from DB)
  - Icing flavor dropdown (dynamic from DB)
  - Writing color dropdown (dynamic from DB)
  - Special notes text area
  - Image upload per layer
✅ Pickup date (min 2 days advance)
✅ Pickup time (optional)
✅ Firm price entry (required)
✅ Deposit amount (validated ≥50%)
✅ Special requests
✅ Order-level image upload
\`\`\`

**UI/UX Changes:**
- "Make symbol for dropdown bigger make the box smaller" → Larger caret icons
- Increased touch target sizes (48px minimum)
- Clear validation error messages
- Progress indicator on multi-step form

---

## Database Schema Deltas

### Tables Removed
- SHOPPING_CART
- CUSTOMER_LOGIN
- PAYMENT_GATEWAY
- CUSTOMER_PREFERENCES
- OCCASION_LOOKUP
- ORDER_TRACKING (moved to ORDER_STATUS with different structure)

### Tables Added
- ORDER_LAYER (per-layer customization)
- ORDER_LAYER_OPTION (junction table)
- ORDER_ATTACHMENT (design images)
- CAKE_SIZE (firm sizes)
- EMPLOYEE (staff management)
- EMPLOYEE_ROLE (access control)

### Table Modifications
- CUSTOM_ORDER:
  - Removed: occasion, servings columns
  - Added: firm_price, cake_size_id columns
  - Changed: total_price semantics to firm_price

- PRODUCT_OPTION:
  - Now supports dynamic loading (no hardcoding)
  - Used for flavor, filling, icing, color selection per layer

---

## API Changes

### Endpoints Removed
\`\`\`
POST   /api/customers/register        ❌ No customer signup
POST   /api/checkout                  ❌ No checkout
POST   /api/payments                  ❌ No online payment
GET    /api/orders/public/:id         ❌ No public tracking
POST   /api/recommendations           ❌ No AI suggestions
\`\`\`

### Endpoints Added
\`\`\`
POST   /api/auth/login                ✅ Staff authentication
GET    /api/products/:id/options      ✅ Dynamic option lists
POST   /api/orders/:id/status         ✅ Status updates
GET    /api/analytics/dashboard       ✅ Revenue reports
GET    /api/analytics/revenue         ✅ Date range reporting
\`\`\`

---

## Feature Status Matrix

| Feature | Original | Current | Status |
|---------|----------|---------|--------|
| Customer Registration | ✅ | ❌ | REMOVED |
| Online Ordering | ✅ | ❌ | REMOVED |
| Online Payment | ✅ | ❌ | REMOVED |
| Occasion Selection | ✅ | ❌ | REMOVED |
| Serving Calculator | ✅ | ❌ | REMOVED |
| 3D Cake Preview | ✅ | ❌ | REMOVED |
| Chatbot Support | ✅ | ❌ | REMOVED |
| Personalization Engine | ✅ | ❌ | REMOVED |
| Staff Login | ❌ | ✅ | ADDED |
| Per-Layer Customization | ❌ | ✅ | ADDED |
| Image Uploads | ❌ | ✅ | ADDED |
| Manager Reports | Partial | ✅ | ENHANCED |
| Order Status Tracking | ❌ | ✅ | ADDED |
| Role-Based Access | Partial | ✅ | ENHANCED |
| Dynamic Dropdowns | ❌ | ✅ | ADDED |

---

## Timeline of Changes

**Pre-Clarification:**
- Week 1-3: Designed customer e-commerce platform
- Week 4: Built customer portal, shopping cart
- Week 5: Integrated Stripe, payment processing

**Post-Clarification (November 5, 2025):**
- Action: Scope pivot from public to staff-only
- Impact: Rework majority of codebase
- Priority: Database schema (ORDER_LAYER, etc.)
- Focus: Staff authentication, order workflow, reports

---

## Testing Impact

### Tests Removed
- Customer login flow tests (16 tests)
- Checkout flow tests (12 tests)
- Payment processing tests (8 tests)
- Recommendation algorithm tests (6 tests)

### Tests Added
- Staff authentication tests (8 tests)
- Per-layer customization tests (12 tests)
- Order validation tests (10 tests)
- Deposit calculation tests (6 tests)
- Manager report tests (8 tests)

**Net Change:** -42 tests → +44 tests

---

## Documentation Updates

**Documents Removed:**
- Customer User Guide
- Payment Processing Guide
- E-Commerce Best Practices

**Documents Added:**
- Scope and Non-Goals
- Information Architecture (staff workflows)
- Database Schema (ORDER_LAYER, per-layer options)
- API Specification (staff endpoints)
- Security & Compliance (staff authentication)

---

## Lessons Learned

1. **Clarification is Critical:** Original scope was based on assumptions, not requirements
2. **Pivot Early:** Major scope change happened mid-project, affecting timelines
3. **Documentation:** Need clear requirements before development
4. **Architecture:** Staff-only changes fundamental architecture (auth, UI, database)
5. **Flexibility:** Team adapted quickly to scope changes

---

## Recommendations for Future Projects

1. Validate scope with stakeholder before development
2. Get written sign-off on requirements
3. Identify "business rules" early (e.g., "customers don't order online")
4. Plan for scope changes (keep flexibility in architecture)
5. Maintain change log from day 1

---

## Related Documents

- **01_SCOPE_AND_NON_GOALS.md** - Current scope (post-clarification)
- **05_ERD_UPDATE_AND_RATIONALE.md** - Database changes
- **08_API_SPEC_AND_ENDPOINTS.md** - Current API endpoints

---

**Status:** Complete  
**Last Updated:** November 5, 2025
